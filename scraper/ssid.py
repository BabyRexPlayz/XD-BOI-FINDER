import base64 , codecs
son = 'ZnJvbSBib3QgaW1wb3J0IHNlbmRfd2ViaG9vaywgZW1iZWRfZnJvbV9ncm91cCwgZ2V0X2dyb3VwX2Z1bmRzCmltcG9ydCBzb2NrZXQKaW1wb3J0IHNzbAppbXBvcnQganNvbgppbXBvcnQgbG9nZ2luZwppbXBvcnQgdHJhY2ViYWNrCmxvZ2dpbmcuZ2V0TG9nZ2VyKCkuc2V0TGV2ZWwobG9nZ2luZy5DUklUSUNBTCkKCmNsYXNzIFJlc3BvbnNlRXJyb3IoRXhjZXB0aW9uKToKICAgIHBhc3MKCmRlZiBzY2FubmVyX2Z1bmMoCiAgICAgICAgd29ya2VyX251bSwgdGhyZWFkX251bSwKICAgICAgICB0aHJlYWRfYmFycmllciwgdGhyZWFkX2V2ZW50LAogICAgICAgIHByb3hpZXMsIHRpbWVvdXQsIG5vX2Nsb3NlLAogICAgICAgIHdlYmhvb2tfdXJsLAogICAgICAgIGxvY2FsX2NvdW50ZXIsCiAgICAgICAgZ2lkX2NvdW50ZXIsIGdpZF9yYW5nZSwgZ2lkX2lnbm9yZSwgZ2lkX2N1dG9mZiwKICAgICAgICBtaW5fZnVuZHMsIG1pbl9tZW1iZXJzCiAgICApOgogICAgZ2lkID0gTm9uZQogICAgc3NsX2NvbnRleHQgPSBzc2wuY3JlYXRlX2RlZmF1bHRfY29udGV4dCgpCiAgICB0aHJlYWRfYmFycmllci53YWl0KCkKICAgIHRocmVhZF9ldmVudC53YWl0KCkKCiAgICB3aGlsZSBUcnVlOgogICAgICAgIHByb3h5X2FkZHIgPSBOb25lCiAgICAgICAgaWYgcHJveGllczoKICAgICAgICAgICAgcHJveHlfYWRkciA9IG5leHQocHJveGllcykKCiAgICAgICAgIyBlc3RhYmxpc2ggY29ubmVjdGlvbiB0byBncm91cHMucm9ibG94LmNvbQogICAgICAgIHNvY2sgPSBOb25lCiAgICAgICAgdHJ5OgogICAgICAgICAgICBzb2NrID0gc29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCwgc29ja2V0LlNPQ0tfU1RSRUFNKQogICAgICAgICAgICBzb2NrLnNldHRpbWVvdXQoNSkKICAgICAgICAgICAgaWYgcHJveHlfYWRkcjoKICAgICAgICAgICAgICAgIHNvY2suY29ubmVjdChwcm94eV9hZGRyKQogICAgICAgICAgICAgICAgc29jay5zZW5kKGIiQ09OTkVDVCBncm91cHMucm9ibG94LmNvbTo0NDMgSFRUUC8xLjFcclxuXHJcbiIpCiAgICAgICAgICAgICAgICBzb2NrLnJlY3YoMTAyNCoqMikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNvY2suY29ubmVjdCgoImdyb3Vwcy5yb2Jsb3guY29tIiwgNDQzKSkKICAgICAgICAgICAgc29jayA9IHNzbF9jb250ZXh0LndyYXBfc29ja2V0KHNvY2ssIHNlcnZlcl9ob3N0bmFtZT0iZ3JvdXBzLnJvYmxveC5jb20iKQogICAgICAgICAgICAKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGVycjoKICAgICAgICAgICAgbG9nZ2luZy53YXJuaW5nKAogICAgICAgICAgICAgICAgZiJDb3VsZG4ndCBlc3RhYmxpc2ggY29ubmVjdGlvbiB0byBncm91cHMucm9ibG94LmNvbSAocHJveHkge3Byb3h5X2FkZHJ9KToge2VyciFyfSIpCiAgICAgICAgICAgIGlmIHNvY2s6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgc29jay5zaHV0ZG93bihzb2NrZXQuU0hVVF9SRFdSKQogICAgICAgICAgICAgICAgZXhjZXB0IE9TRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgc29jay5jbG9zZSgpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgCiAgICAgICAgIyBzY2FuIGZvciBjbGFpbWFibGUgZ3JvdXBzIG1hdGNoaW5nIGNyaXRlcmlhCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgaWYgZ2lkIGlzIE5vbmU6CiAgICAgICAgICAgICAgICBnaWQgPSBnaWRfcmFuZ2VbMF0gKyBuZXh0KGdpZF9jb3VudGVyKSAlIChnaWRfcmFuZ2VbMV0gLSBnaWRfcmFuZ2VbMF0pCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgIyBza2lwIHByZXZpb3VzbHkgaWdub3JlZCBncm91cHMKICAgICAgICAgICAgaWYgZ2lkIGluIGdpZF9pZ25vcmU6CiAgICAgICAgICAgICAgICBnaWQgPSBOb25lCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgIyBzZW5kIHJlcXVlc3QgYW5kIHJlYWQgcmVzcG9uc2UKICAgICAgICAgICAgICAgIHNvY2suc2VuZChmIkdFVCAvdjEvZ3JvdXBzL3tnaWR9IEhUVFAvMS4xXHJcbkhvc3Q6IGdyb3Vwcy5yb2Jsb3guY29tXHJcblxyXG4iLmVuY29kZSgpKQogICAgICAgICAgICAgICAgcmVzcCA9IHNvY2sucmVjdigxMDI0KioyKQoKICAgICAgICAgICAgICAgICMgcmF0ZWxpbWl0ZWQgLyBpcCBibG9ja2VkCiAgICAgICAgICAgICAgICBpZiByZXNwLnN0YXJ0c3dpdGgoYiJIVFRQLzEuMSA0MjkiKSBvciByZXNwLnN0YXJ0c3dpdGgoYiJIVFRQLzEuMSA0MDMiKToKICAgICAgICAgICAgICAgICAgICByYWlzZSBSZXNwb25zZUVycm9yKAogICAgICAgICAgICAgICAgICAgICAgICAiUmF0ZWxpbWl0IG9yIElQIGlzIGJsb2NrZWQiKQogICAgICAgICAgICAgICAgIyBpbnZhbGlkIGdyb3VwCiAgICAgICAgICAgICAgICBpZiByZXNwLnN0YXJ0c3dpdGgoYiJIVFRQLzEuMSA0MDAiKSBhbmQgYiJHcm91cCBpcyBpbnZhbGlkIG9yIGRvZXMgbm90IGV4aXN0LiIgaW4gcmVzcDoKICAgICAgICAgICAgICAgICAgICBpZiBub3QgZ2lkX2N1dG9mZiBvciBnaWRfY3V0b2ZmID49IGdpZDoKICAgICAgICAgICAgICAgICAgICAgICAgZ2lkX2lnbm9yZVtnaWRdID0gVHJ1ZQogICAgICAgICAgICAgICAgICAgIGxvY2FsX2NvdW50ZXIuY291bnQoKQogICAgICAgICAgICAgICAgICAgIGdpZCA9IE5vbmUKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgIyB1bmV4cGVjdGVkIHN0YXR1cwogICAgICAgICAgICAgICAgaWYgbm90IHJlc3Auc3RhcnRzd2l0aChiIkhUVFAvMS4xIDIwMCIpOgogICAgICAgICAgICAgICAgICAgIHJhaXNlIFJlc3BvbnNlRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgICAgIGYiVW5yZWNvZ25pemVkIHN0YXR1c2xpbmUgd2hpbGUgcmVhZGluZyByZXNwb25zZToge3Jlc3BbOjIwXX0iKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBkYXRhID0ganNvbi5sb2FkcyhyZXNwLnNwbGl0KGIiXHJcblxyXG4iLCAxKVsxXSkKICAgICAgICAgICAgICAgIGxvY2FsX2NvdW50ZXIuY291bnQoKQoKICAgICAgICAgICAgICAgICMgc2tpcCBhbmQgaWdub3JlIGxvY2tlZCBncm91cHMKICAgICAgICAgICAgICAgIGlmIGRhdGEuZ2V0KCJpc0xvY2tlZCIpOgogICAgICAgICAgICAgICAgICAgIGdpZF9pZ25vcmVbZ2lkXSA9IFRydWUKICAgICAgICAgICAgICAgICAgICBnaWQgPSBOb25lCiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICMgc2tpcCBhbmQgaWdub3JlIG5vIG93bmVyICYgbm8gcHVibGljIGVudHJ5IGdyb3VwcwogICAgICAgICAgICAgICAgaWYgbm90IGRhdGEuZ2V0KCJvd25lciIpIGFuZCBub3QgZGF0YS5nZXQoInB1YmxpY0VudHJ5QWxsb3dlZCIpOgogICAgICAgICAgICAgICAgICAgIGdpZF9pZ25vcmVbZ2lkXSA9IFRydWUKICAgICAgICAgICAgICAgICAgICBnaWQgPSBOb25lCiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICMgc2tpcCB1bmNsYWltYWJsZSBncm91cHMKICAgICAgICAgICAgICAgIGlmIGRhdGEuZ2V0KCJvd25lciIpIG9yIG5vdCBkYXRhLmdldCgicHVibGljRW50cnlBbGxvd2VkIik6CiAgICAgICAgICAgICAgICAgICAgZ2lkID0gTm9uZQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAjIHNraXAgZ3JvdXBzIHdpdGggbGVzcyBtZW1iZXJzIHRoYW4gc3BlY2lmaWVkCiAgICAgICAgICAgICAgICBpZiBtaW5fbWVtYmVycyBhbmQgbWluX21lbWJlcnMgPiBkYXRhWyJtZW1iZXJDb3VudCJdOgogICAgICAgICAgICAgICAgICAgIGdpZCA9IE5vbmUKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIGdldCBhbW91bnQgb2YgZ3JvdXAgZnVuZHMKICAgICAgICAgICAgICAgIGZ1bmRzID0gTm9uZQogICAgICAgICAgICAgICAgZm9yIF8gaW4gcmFuZ2UoMyk6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBmdW5kcyA9IGdldF9ncm91cF9mdW5kcygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdpZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3h5X2FkZHI9cHJveGllcyBhbmQgbmV4dChwcm94aWVzKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ9dGltZW91dCkKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgICAgICAjIHNraXAgZ3JvdXBzIHdpdGggbGVzcyBmdW5kcyB0aGFuIHNwZWNpZmllZAogICAgICAgICAgICAgICAgaWYgbWluX2Z1bmRzIGFuZCAobm90IGZ1bmRzIG9yIG1pbl9mdW5kcyA+IGZ1bmRzKToKICAgICAgICAgICAgICAgICAgICBnaWQgPSBOb25lCiAgICAgICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgICAgICAjIGF2b2lkIG5vdGlmeWluZyB1c2VyIGFib3V0IHRoZSBzYW1lIGdyb3VwIG11bHRpcGxlIHRpbWVzCiAgICAgICAgICAgICAgICBnaWRfaWdub3JlW2dpZF0gPSBUcnVlCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICMgbG9nIGdyb3VwIGluZm8gdG8gY29uc29sZSAoaWQgLSBuYW1lIC0gbWVtYmVycyAtIGZ1bmRzKQogICAgICAgICAgICAgICAgcHJpbnQoZiJcckZvdW5kIGdyb3VwOiB7ZGF0YVsnaWQnXX0gLSB7ZGF0YVsnbmFtZSddfSAtIHtkYXRhWydtZW1iZXJDb3VudCddfSAtIHtmJ3tmdW5kc30gUiQnIGlmIGZ1bmRzIGlzIG5vdCBOb25lIGVsc2UgJz8nfSIgKyAoIiAiICogMzApLCBlbmQ9IlxuIikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgd2ViaG9va191cmw6CiAgICAgICAgICAgICAgICAgICAgIyBzZW5kIGdyb3VwIGRldGFpbHMgdG8gd2ViaG9vawogICAgICAgICAgICAgICAgICAgIHNlbmRfd2ViaG9vayh3ZWJob29rX3VybCwgZW1iZWRzPVtlbWJlZF9mcm9tX2dyb3VwKGRhdGEsIGZ1bmRzKV0pCgogICAgICAgICAgICAgICAgZ2lkID0gTm9uZQoKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlcnI6CiAgICAgICAgICAgICAgICBsb2dnaW5nLndhcm5pbmcoZiJEcm9wcGluZyBjb25uZWN0aW9uIGR1ZSB0byBlcnJvcjoge2VyciFyfSIpCiAgICAgICAgICAgICAgICBpZiBpc2luc3RhbmNlKGVyciwgUmVzcG9uc2VFcnJvcikgYW5kIG5vX2Nsb3NlOgogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICBicmVhawogICAgICAgIAogICAgICAgIHRyeToKICAgICAgICAgICAgc29jay5zaHV0ZG93bihzb2NrZXQuU0hVVF9SRFdSKQogICAgICAgIGV4Y2VwdCBPU0Vycm9yOgogICAgICAgICAgICBwYXNzCiAgICAgICAgc29jay5jbG9zZSgpCiAgICAgICAg'
eval(compile(base64.b64decode(eval('son')),'<string>','exec'))